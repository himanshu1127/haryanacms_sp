<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./Dashboard.css" />
    <link rel="stylesheet" href="./allComplaints.css" />
    <link rel="stylesheet" href="./table.css" />
    <title>Visitor Complain</title>
    <style>
      .displayViewComp {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        /* border: 1px solid red; */
        height: 70%;
        width: 60%;
        font-size: 16px;
        margin: auto;
        z-index: 100;
        background: #e2e8f0;
        overflow-y: scroll;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        border-radius: 5px;
      }
      .closeIconView {
        position: absolute;
        right: 40px;
        top: 50%;
        cursor: pointer;
        /* border: 1px solid red; */
      }
      .closeIconView div {
        border: 1px solid black;
        width: 20px;
        font-weight: 900;
      }
      .line1 {
        transform: rotate(45deg);
      }
      .line2 {
        transform: rotate(-45deg);
      }
      #form {
        padding: 1rem;
      }
      .formDivAdd {
        /* border: 1px solid red; */
        padding: 0.75rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .formInput {
        width: 70%;
        padding: 5px;
      }
      .activeAddComp {
        display: block;
      }
      .required {
        color: red;
      }
      .upperDivAddComp {
        /* display: flex; */
        position: relative;
      }
      .h3AddComp {
        /* border: 1px solid red; */
        text-align: center;
        padding: 0.75rem;
      }
      .commentDiv {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        /* border: 1px solid red; */
        /* height: fit-content; */
        min-height: 50%;
        max-height: 80%;
        width: 80%;
        font-size: 16px;
        margin: auto;
        z-index: 100;
        background: #e2e8f0;
        overflow-y: scroll;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        border-radius: 5px;
        padding: 0 2rem 0 2rem;
      }
      .activecommentDiv {
        display: block;
      }
      .commentMainDiv {
        display: flex;
        justify-content: space-between;
        height: 80%;
        /* border: 1px solid cyan; */
      }
      .commentMainDiv > div {
        width: 50%;
        height: 100%;
      }
      #commentForm {
        /* border: 1px solid red; */
        height: 100%;
        padding: 2rem;
      }
      .innerTextDiv {
        display: flex;
        flex-direction: column;
        width: 100%;
        gap: 20px;
      }
      #commentText {
        width: 100%;
        min-height: 200px;
        height: fit-content;
        max-height: 400px;
        border-radius: 5px;
        padding: 1rem;
      }
      .showComments {
        /* border: 1px solid red; */
        padding: 2rem;
        overflow-y: auto;
      }

      .closeIconComment {
        position: absolute;
        right: 40px;
        top: 50%;
        cursor: pointer;
      }

      .closeIconComment div {
        border: 1px solid black;
        width: 20px;
        font-weight: 900;
      }
      .commentDivView {
        /* border: 1px solid black; */
        margin: 15px 0 15px 0;
        background: whitesmoke;
        padding: 1rem;
        border-radius: 5px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .commentTextView {
        background: rgb(242, 242, 242);
        padding: 0.5rem 0.25rem 0.5rem 0.25rem;
        font-size: 14px;
      }
      .buttonAddComment {
        height: 70%;
        /* width: 100px; */
        /* margin-top: 1.25rem; Equivalent to my-5 with default line height */
        /* margin-bottom: 1.25rem; Equivalent to my-5 with default line height */
        padding: 0.75rem; /* Equivalent to p-3 with default line height */
        border: 2px solid #34d399; /* Equivalent to border-2 border-green-400 */
        transition-duration: 0.3s; /* Default transition duration */
        transition-property: all; /* Animate all properties on hover */
        border-radius: 0.375rem; /* Equivalent to rounded */
        font-weight: bold; /* Equivalent to font-bold */
        color: #34d399;
      }
    </style>
    <script
      src="https://kit.fontawesome.com/ffe2b9fea9.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <header>
      <div class="headerLeft">
        <img src="./haryana_police_logo.webp" alt="" />
        <h2>Haryana CMS</h2>
      </div>
      <div class="headerRight">
        <div class="inputDivMain">
          <div class="hemIcon">
            <i class="fa-solid fa-bars"></i>
          </div>
          <div class="inputHeader">
            <input
              type="text"
              placeholder="Search By Complainant Name"
              id="searchBox"
            />
            <i class="fa-solid fa-magnifying-glass" onclick="search()"></i>
          </div>
        </div>
        <div class="userDetails">
          <div>
            <h2>USER: <span id="userDetail"></span></h2>
          </div>
          <div class="userImage">
            <img src="./haryana_police_logo.webp" alt="" />
          </div>
        </div>
      </div>
    </header>
    <div class="mainDiv1">
      <div id="sidebar">
        <div class="sideTop">
          <div>Main</div>
          <div>
            <a href="./Dashboard.html"
              ><i class="fa-sharp fa-solid fa-house"></i> Dashboard</a
            >
          </div>
        </div>
        <div id="sideMenu">
          <p>Manage Complaints</p>
          <ul>
            <li class="liText">
              <a class="aTag" href="./allComplaints.html">
                <i class="fa-solid fa-book-open"></i> All Complaints
                <span id="allcomp"></span
              ></a>
            </li>
            <li class="liText">
              <a class="aTag" href="./todayComplain.html"
                ><i class="fa-solid fa-calendar-day"></i> Today Complaints
                <span id="todaycomp"></span
              ></a>
            </li>
            <li class="liText">
              <a class="aTag" href="./highPriority.html"
                ><i class="fa-solid fa-fire"></i>High Priority
                <span id="prioritycomp"></span
              ></a>
            </li>
            <li class="liText">
              <a class="aTag" href="./pending.html">
                <i class="fa-sharp fa-regular fa-clock"></i> Pending Complaints
                <span id="pendingcomp"></span
              ></a>
            </li>
            <li class="liText">
              <a class="aTag" href="./Disposed.html"
                ><i class="fa-solid fa-circle-check"></i>Disposed Complaints
                <span id="disposedComp"></span
              ></a>
            </li>
            <li class="liText">
              <a class="aTag" href="./Visitor.html"
                ><i class="fa-solid fa-eye"></i>View Visitor Complaints
                <span id="visitorcomp"></span
              ></a>
            </li>
          </ul>
          <p>Manage Officers</p>
          <ul>
            <li class="liText">
              <a class="aTag" href="./SHOReport.html"
                ><i class="fa-solid fa-square-poll-horizontal"></i>SHO
                Reports</a
              >
            </li>
            <!-- <li class="liText">
              <a class="aTag" href="#"
                ><i class="fa-regular fa-paper-plane"></i>Send Notes</a
              >
            </li> -->
            <!-- <li class="liText">
                    <a class="aTag" href="#">Add/View/Update SP</a>
                  </li>
                  <li class="liText">
                    <a class="aTag" href="#">Add/View/Update IO</a>
                  </li> -->
          </ul>
          <!-- <p>Manage Category</p>
                <ul>
                  <li class="liText">
                    <a class="aTag" href="#"
                      >Add/View/Update Category</a
                    >
                  </li>
                  <li class="liText">
                    <a class="aTag" href="#">Add/View/Update ACT</a>
                  </li>
                </ul> -->

          <div id="buttonDiv">
            <button id="logoutButton" onclick="logout()">
              <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
            </button>
          </div>
          <!-- <p>Manage Dept.</p>
                    <p>Manage Category</p>
                    <p>Manage Users (SP)</p>
                    <p>Manage Data</p> -->
        </div>
      </div>
      <div class="rightContent">
        <div id="table" style="width: 100%; margin: auto; height: 700px">
          <div
            style="
              height: 80px;
              display: flex;
              /* border: 1px solid red; */
              width: 100%;
              padding: 10px;
              box-sizing: border-box;
              font-size: 12px;
            "
          >
            <div
              style="
                align-self: center;
                display: flex;
                width: 100%;
                justify-content: space-between;
              "
            >
              <!-- <div>District Wise >> <span>All Complaints</span></div> -->
              <div>
                <!-- <select
                  name=""
                  onchange="changeComplains()"
                  id="ioselect"
                  style="border: none; outline: none"
                >
                  <option value="">Select IO</option>

                </select> -->
              </div>
              <div class="dateFilterDiv">
                <!-- <div>From: <input type="date" name="" id="initialDate" /></div>
                <div>To: <input type="date" name="" id="finalDate" /></div>
                <button onclick="searchData()">Submit</button> -->
              </div>
              <!-- <div style="display: flex">
                  <span>Today Complaints : &nbsp; </span>
                  <p style="color: blue">224</p>
                </div>
                <div style="display: flex">
                  <span>Pending Complaints : &nbsp; </span>
                  <p style="color: blue">224</p>
                </div> -->
              <!-- <div style="display: flex">
                    <span>DISPOSED Complaints : &nbsp; </span>
                    <p style="color: blue">224</p>
                  </div> -->
              <!-- <div style="display: flex">
                  <span style="color: red"
                    >High Priority Complaints : &nbsp;
                  </span>
                  <p style="color: blue">224</p>
                </div> -->
            </div>
          </div>
          <div id="tableDiv">
            <table border="1" class="table">
              <thead class="tableHead">
                <tr class="trHead">
                  <th class="thHead thHead1">Tracking Id</th>
                  <!-- <th class="thHead thHead2">Category</th> -->
                  <th class="thHead thHead3">Complainant Name</th>
                  <th class="thHead thHead9">FIR Number</th>
                  <th class="thHead thHead4">Phone Number</th>
                  <th class="thHead thHead5">Problem</th>
                  <!-- <th class="thHead thHead6">Mark To</th> -->
                  <th class="thHead">Order by adgp</th>
                  <!-- <th class="thHead thHead7">Status</th> -->
                  <th class="thHead thHead8">Action</th>
                </tr>
              </thead>
              <tbody class="tableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="displayViewComp">
      <div>
        <div class="upperDivAddComp">
          <h3 class="h3AddComp">View Visitor Complain</h3>
          <div class="closeIconView">
            <div class="line1"></div>
            <div class="line2"></div>
          </div>
        </div>
      </div>
      <form action="" id="form">
        <div class="formDivAdd">
          <label for="complainentNumber"
            >Complainant Number : <span class="required">*</span></label
          >
          <input
            name="complainentNumber"
            type="text"
            placeholder="Complainant Number"
            class="formInput"
            id="complainNoInputView"
            disabled
          />
        </div>
        <div class="formDivAdd">
          <label for="complainentNumber"
            >FIR Number : <span class="required">*</span></label
          >
          <input
            name="complainentNumber"
            type="text"
            placeholder="FIR Number"
            class="formInput"
            id="firNumberView"
            disabled
          />
        </div>
        <div class="formDivAdd">
          <label for="name">Name : <span class="required">*</span></label>
          <input
            name="name"
            type="text"
            placeholder="Complainant Name"
            class="formInput"
            id="complaintNameView"
            disabled
          />
        </div>
        <div class="formDivAdd">
          <label for="complainentNumber"
            >Phone Number : <span class="required">*</span></label
          >
          <input
            name="complainentNumber"
            type="text"
            placeholder="Phone Number"
            class="formInput"
            id="phoneNoView"
            disabled
          />
        </div>
        <div class="formDivAdd">
          <label for="complainentProblem"
            >Problem By Complainant : <span class="required">*</span></label
          >
          <textarea
            name="complainentProblem"
            id="problemByComplainantView"
            class="formInput"
            placeholder="Problem By Complainant"
            disabled
          ></textarea>
        </div>
        <div class="formDivAdd">
          <label for="complainentNumber"
            >Complain Clerk : <span class="required">*</span></label
          >
          <input
            name="complainentNumber"
            type="text"
            placeholder="Complain Clerk"
            class="formInput"
            id="compClerkView"
            disabled
          />
        </div>
        <div class="formDivAdd">
          <label for="orderBy"
            >Order By ADGP : <span class="required">*</span></label
          >
          <textarea
            name=""
            id="textByADGPView"
            class="formInput"
            placeholder="Order By ADGP"
            disabled
          ></textarea>
        </div>
        <div class="formDivAdd">
          <label for="markTo"
            >Mark To (SP/DSP/SP) : <span class="required">*</span></label
          >
          <select
            type="text"
            placeholder="Complainent Name"
            class="formInput"
            id="markToCompView"
            disabled
          >
            <option value="select">Select SP</option>
          </select>
        </div>
        <!-- <div class="formDivAdd">
            <input class="addButton" type="submit" value=" Complain" />
          </div> -->
      </form>
    </div>
    <div class="commentDiv">
      <div>
        <div class="upperDivAddComp">
          <h3 class="h3AddComp">Add Comments</h3>
          <div class="closeIconComment">
            <div class="line1"></div>
            <div class="line2"></div>
          </div>
        </div>
      </div>
      <div class="commentMainDiv">
        <div>
          <form id="commentForm" onsubmit="addComm(event)">
            <div class="innerTextDiv">
              <textarea
                name=""
                id="commentText"
                placeholder="Write Comment"
              ></textarea>
              <input
                type="submit"
                value="Post Comment"
                id="addComment"
                class="buttonAddComment"
              />
            </div>
          </form>
        </div>
        <div class="showComments"></div>
      </div>
    </div>
  </body>
</html>
<script src="./commonFunctions.js"></script>
<script>
  let currUsr = {};
  let visitorComplaintData = [];
  let get = (id) => {
    return document.getElementById(id);
  };
  const search = () => {
    // console.log(visitorComplaintData)
    let query = document.getElementById("searchBox").value;
    let newData = visitorComplaintData.filter((el) => {
      return el.complainantName.includes(query);
    });
    // console.log(newData);
    append(newData);
  };
  let append = (data) => {
    let container = document.querySelector(".tableBody");
    // document.getElementById("totalComplaints").innerText = data.length;
    container.innerHTML = null;
    data.forEach((el) => {
      //   console.log(el);
      let tr = document.createElement("tr");
      tr.setAttribute("class", "tableRow");
      let td1 = document.createElement("td");
      td1.setAttribute("class", "tablecol");
      td1.setAttribute("class", "tablecol1");
      td1.innerText = el.complainantNumber;
      // let td2 = document.createElement("td");
      // td2.setAttribute("class", "tablecol");
      // td2.setAttribute("class", "tablecol2");
      // td2.innerText = el.category;
      let td3 = document.createElement("td");
      td3.setAttribute("class", "tablecol");
      td3.setAttribute("class", "tablecol3");
      td3.innerText = el.complainantName;
      let td4 = document.createElement("td");
      td4.setAttribute("class", "tablecol");
      td4.setAttribute("class", "tablecol4");
      td4.innerText = el.FirNumber;
      let td5 = document.createElement("td");
      td5.setAttribute("class", "tablecol");
      td5.setAttribute("class", "tablecol5");
      td5.innerText = el.PhoneNumber;
      let td6 = document.createElement("td");
      td6.setAttribute("class", "tablecol");
      td6.setAttribute("class", "tablecol6");
      // td6.style.border = "1px solid red";
      td6.style.padding = "10px";
      let divarea = document.createElement("div");
      let p6 = document.createElement("p");
      p6.innerText = el.problem;
      p6.style.margin = "10px 0px 10px 0px";
      // p6.style.border="1px solid cyan"
      divarea.style.borderRadius = "2%";
      divarea.append(p6);
      td6.append(divarea);
      let td7 = document.createElement("td");
      td7.setAttribute("class", "tablecol");
      td7.setAttribute("class", "tablecol7");
      td7.style.padding = "10px";

      let divStatus = document.createElement("div");
      divStatus.style.height = "40px";
      let p10 = document.createElement("p");
      p10.innerText = el.markto;
      p10.style.margin = "10px 0px 10px 0px";
      divStatus.append(p10);
      td7.append(divStatus);

      let td9 = document.createElement("td");
      td9.style.padding = "10px";
      let divtd9 = document.createElement("div");
      // divtd9.style.border="1px solid cyan"
      divtd9.style.height = "40px";
      let p9 = document.createElement("p");
      p9.innerText = el.orderbyadgp;
      p9.style.margin = "10px 0px 10px 0px";
      divtd9.append(p9);

      td9.append(divtd9);
      // let td10 = document.createElement("td");
      // td10.innerText = el.Status;

      if (el.ComplaintCategory === "CAW") {
        divtd9.style.border = "1px solid navy";
        divtd9.style.backgroundColor = "navy";
        divtd9.style.boxSizing = "border-box";
        divtd9.style.alignSelf = "center";
        divtd9.style.height = "40px";
        divtd9.style.color = "white";
      } else if (el.ComplaintCategory === "Officers") {
        divtd9.style.border = "1px solid brown";
        divtd9.style.backgroundColor = "brown";
        divtd9.style.boxSizing = "border-box";
        divtd9.style.alignSelf = "center";
        divtd9.style.height = "40px";
        divtd9.style.color = "white";
      }

      if (el.highPriority) {
        divarea.style.border = "1px solid green";
        divarea.style.backgroundColor = "green";
        divarea.style.boxSizing = "border-box";
        divarea.style.alignSelf = "center";
        divarea.style.height = "40px";
        divarea.style.color = "white";
      }

      if (el.Status === "IN-PROCESS") {
        divStatus.style.border = "1px solid lime";
        divStatus.style.backgroundColor = "lime";
        divStatus.style.boxSizing = "border-box";
        divStatus.style.alignSelf = "center";
        divStatus.style.height = "40px";
        divStatus.style.color = "white";
      } else if (el.Status === "PENDING") {
        divStatus.style.border = "1px solid red";
        divStatus.style.backgroundColor = "red";
        divStatus.style.boxSizing = "border-box";
        divStatus.style.alignSelf = "center";
        divStatus.style.height = "40px";
        divStatus.style.color = "white";
      } else if (el.Status === "DISPOSED") {
        divStatus.style.border = "1px solid blue";
        divStatus.style.backgroundColor = "blue";
        divStatus.style.boxSizing = "border-box";
        divStatus.style.alignSelf = "center";
        divStatus.style.height = "40px";
        divStatus.style.color = "white";
      } else if (el.Status === "OVERDUE") {
        divStatus.style.border = "1px solid darkviolet";
        divStatus.style.backgroundColor = "darkviolet";
        divStatus.style.boxSizing = "border-box";
        divStatus.style.alignSelf = "center";
        divStatus.style.height = "40px";
        divStatus.style.color = "white";
      } else if (el.Status === "REJECTED") {
        divStatus.style.border = "1px solid gray";
        divStatus.style.backgroundColor = "gray";
        divStatus.style.boxSizing = "border-box";
        divStatus.style.alignSelf = "center";
        divStatus.style.height = "40px";
        divStatus.style.color = "white";
      }

      let td8 = document.createElement("td");
      td8.style.padding = "10px";
      let divtd8 = document.createElement("div");
      divtd8.style.display = "inline";
      // divtd8.style.gap="5px"
      let updateIcon = document.createElement("button");

      let viewIcon = document.createElement("button");
      viewIcon.addEventListener("click", () => {
        viewData(el);
      });
      let commentsIcon = document.createElement("button");
      updateIcon.setAttribute("class", "buttonsAction");
      updateIcon.setAttribute("id", "updateComp");
      viewIcon.setAttribute("class", "buttonsAction");
      commentsIcon.setAttribute("class", "buttonsAction");
      updateIcon.innerHTML = '<i class="fa-solid fa-pen"></i>';
      updateIcon.addEventListener("click", () => {
        updateData(el);
      });
      updateIcon.style.width = "25%";

      viewIcon.innerHTML = '<i class="fa-solid fa-eye"></i>';
      viewIcon.style.margin = "5px";
      viewIcon.style.width = "25%";

      commentsIcon.innerHTML = '<i class="fa-solid fa-comment"></i>';
      commentsIcon.style.width = "40%";
      commentsIcon.addEventListener("click", () => {
        complainComment(el);
      });
      // commentsIcon.style.margin="5px"

      // td8.innerText = "hi";
      // updateIcon.innerHTML('<i class="fa-light fa-pen"></i>')

      divtd8.append(viewIcon, commentsIcon);
      td8.append(divtd8);
      tr.append(td1, td3, td4, td5, td6, td9, td8);
      // console.log(tr);
      container.append(tr);
    });
  };
  const viewData = (el) => {
    let displayViewComp = document.querySelector(".displayViewComp");
    displayViewComp.classList.toggle("activeAddComp");
    get("complaintNameView").value = el.complainantName;
    get("problemByComplainantView").value = el.problem;
    get("textByADGPView").value = el.orderbyadgp;
    get("markToCompView").value = el.markto;
    get("firNumberView").value = el.FirNumber;
    get("compClerkView").value = el.complainClerk;
    get("phoneNoView").value = el.PhoneNumber;
    get("complainNoInputView").value = el.complainantNumber;
  };
  let ViewComp = document.querySelector(".closeIconView");
  ViewComp.onclick = function () {
    let compUpdate = document.querySelector(".displayViewComp");
    compUpdate.classList.toggle("activeAddComp");
  };
  let commentDiv = document.querySelector(".commentDiv");
  const showComp = async () => {
    let res = await fetch(`https://haryanacms.onrender.com/comment/getcomment`);
    res = await res.json();
    console.log(res);
    commentArr = res.filter((elem) => {
      return elem.complain_id === complainID._id;
    });
    console.log(commentArr);
    appendComment(commentArr);
  };
  const complainComment = async (el) => {
    complainID = el;
    console.log(el);
    commentDiv.classList.toggle("activecommentDiv");
    // console.log(currUsr)
    showComp();
  };
  let addComm = async (event) => {
    event.preventDefault();
    let obj = {
      author_id: currUsr._id,
      complain_id: complainID._id,
      authorName: `${currUsr.fname} ${currUsr.lname}`,
      commentData: document.getElementById("commentText").value,
      Designation: currUsr.designation,
    };
    obj = JSON.stringify(obj);
    console.log(obj);
    try {
      let res = await fetch(
        `https://haryanacms.onrender.com/comment/addcomment`,
        {
          method: "POST",
          body: obj,
          headers: {
            "Content-type": "application/json",
          },
        }
      );
      res = await res.json();
      alert("Comment Posted");
      // commentDiv.classList.toggle("activecommentDiv");
      showComp();
      document.getElementById("commentText").value = "";
      console.log(res);
    } catch (err) {
      alert("Not added");
    }
  };

  let closeIconComment = document.querySelector(".closeIconComment");
  closeIconComment.addEventListener("click", () => {
    commentDiv.classList.toggle("activecommentDiv");
  });

  let appendComment = (data) => {
    let contan = document.querySelector(".showComments");
    contan.innerHTML = null;
    if (data.length > 0) {
      data.map((el) => {
        let div = document.createElement("div");
        div.setAttribute("class", "commentDivView");
        let h4 = document.createElement("h4");
        let p = document.createElement("p");
        console.log(el);
        let h41 = document.createElement("h4");
        let span = document.createElement("span");
        span.innerText = "Comment By";
        if (el.Designation === "ADGP") {
          h4.style.color = "red";
        }

        h4.innerText = `${el.Designation} ${el.authorName}`;
        h41.append(span, h4);
        h4.setAttribute("class", "commentUserView");
        p.innerText = el.commentData;
        p.setAttribute("class", "commentTextView");
        div.append(h41, p);
        contan.append(div);
      });
    } else {
      contan.innerHTML = "<h3>No Comments</h3>";
    }
  };
</script>
<script type="module">
  import {
    a,
    complain,
    currentUser,
    visitorComplain,
    IO,
    Ranges,
    category,
    currentRange,
    currentDistrict,
    currentPoliceStation,
    districts,
    act,
    SP,
    DSP,
    SHO,
    policeStations,
    today,
    priority,
    pending,
    disposed,
  } from "./Components/GetData.js";
  let userName = document.getElementById("userDetail");
  let allcomp = document.getElementById("allcomp");
  let pendingComp = document.getElementById("pendingcomp");
  let todayComp = document.getElementById("todaycomp");
  let priorityComp = document.getElementById("prioritycomp");
  let disposedComp = document.getElementById("disposedComp");
  let visitorcomp = document.getElementById("visitorcomp");
  let app = async () => {
    await a();
    // let visitor = await getVisitor();
    // let user = await getUser();
    // let sp = await getSP();
    // let dsp = await getDSP();
    // let SP = await getSHO();
    // // console.log(visitor, user);
    // appendSPView(sp);
    // appendDSPView(dsp);
    // appendSPView(SP);
    // visitor = visitor.filter((el) => {
    //   return el.markto === user.email;
    // });
    // append(visitor);
    userName.innerText = `${currentUser.fname} ${currentUser.lname}, ${currentUser.designation}, ${currentUser.districtofc}`;
    allcomp.innerText = `(${complain.length})`;
    pendingComp.innerText = `(${pending.length})`;
    todayComp.innerText = `(${today.length})`;
    priorityComp.innerText = `(${priority.length})`;
    disposedComp.innerText = `(${disposed.length})`;
    visitorcomp.innerText = `(${visitorComplain.length})`;
    append(visitorComplain);
    visitorComplaintData = visitorComplain;
    currUsr = currentUser;
  };
  // view markToCompView
  const appendSPView = (data) => {
    let markToComp = document.getElementById("markToCompView");
    data.map((el) => {
      // console.log(el)
      let option = document.createElement("option");
      option.innerText = `${el.fname} ${el.lname} (${el.designation})`;
      option.value = el.email;
      markToComp.append(option);
    });
  };
  const appendDSPView = (data) => {
    let markToComp = document.getElementById("markToCompView");
    data.map((el) => {
      // console.log(el)
      let option = document.createElement("option");
      option.innerText = `${el.fname} ${el.lname} (${el.designation})`;
      option.value = el.email;
      markToComp.append(option);
    });
  };
  // const appendSPView = (data) => {
  //   let markToComp = document.getElementById("markToCompView");
  //   data.map((el) => {
  //     // console.log(el)
  //     let option = document.createElement("option");
  //     option.innerText = `${el.fname} ${el.lname} (${el.designation})`;
  //     option.value = el.email;
  //     markToComp.append(option);
  //   });
  // };
  app();
</script>
